const { ApiPromise, WsProvider } = require("@polkadot/api");
const defaultKsmEndPoint = "wss://kusama.elara.patract.io/";

let provider = null;
let api = null;

async function getApi() {
  if (!api) {
    provider = new WsProvider(defaultKsmEndPoint);
    api = await ApiPromise.create({ provider });
  }

  return api;
}

const eventsHex = '0x200000000000000050e90b0b0000000002000000010000003501d1070000ced9b4669f3eb6908aaa3ea3b77cb1629701ce1323bca31abe756e3a3d650a95f01fbe08145416339f704d5b828c97a0f6dccfb7b90ec63a2d070892d0d65e1054095a3c703440a77ac2f80aa2551e42b1ac7b915083a4c66676a41de56db4ce12ca3d690ac6ac55099de4ea974857b76a4d82a5502736d3502aef614023665189939310995583a548b3acc571a15184e7b0caf9b14743cf42fac1947f787e7de82b77014049be851bb3dec78d771aea65f5e1ad0ea6d0f4e4b87fcc14da19147a38f55ae7279b753abb3cab9a93ed8f276e331905f417bf8f4609d8b726c083f0491dfa549dc69eb7b4d46c323f64acfee1734f5801bcaf1399e041d6bd947fb57f02fff5f0031c025dcfd23ae26221d8f758daa0fb46e7bd3e571540e13d5c1ad375985b23bdef4e685b407ec675104fdbf0cc0c86e98843ce36812838daafe1021ea15504b343bf61e8fc370703420952b37b0fea01e61cb08c727a06dea1beb5e5feab2317fb6c2d0c6da9862a9bc52e0661cd6c4bc6559dc2a135ffdb1a688c6b178a52466bf64d15da042d2adb321edd058b5365a3f8ff5387ee04281e498245c2080661757261206bdf14080000000005617572610101ea564981ff4055efd067fcf438fde79f5df81b311db91ef005d4472d5e9de85fc125acbecf9881989ef83054dd4516e3a0c084500c5b1aa63e99270f6c51c28b02000000020000000000010000003501e7070000ced9b4669f3eb6908aaa3ea3b77cb1629701ce1323bca31abe756e3a3d650a95087b595927907714692b05d95d1fd25f587b050b62be3ebdbbf5a37ebd116118436f099a22f40775c193a9fe7913161c902b490a38e0930c37ed7397c3056cb2aae9d56acc5b253ec42bd1236521887075d822596b3a29c650cc8eeb564c5c01d9d09dbb0a230c933b9521f21bbcf13192ecc7558e065c2f8a6f36e3aa8768cf7c07cabf311c796b235b7d95a432ad0a7c3a90e13b9e8ccb6e5fd6d4d51db85a5d71a688e7e0d23d92eebbc1b686a48bdee8cb35984c919030b9772d5dcab181594429f2b155c94900047137dbb96c3f299e0930b6158324510c20f52f2a1bf30180ee63bf0c715462bfcdd8de7072ff462af9ce99226a06b79bb1a581e71449fff9702e58aa1ea88cde9b9744996880d457a6428c6cf207e2c97234f9c8592ae903dea7c242e71f4deb42e7c231a4b39c77ecdf732dc53dcbaf8d974ec5bc874e0d420e0a0019ca975d43e00cfe3a69f9545d1b7d90824ba88fae90c608e19bf4c429a9f65fded09861a4c45567d10a2656b9bad11c04695fc6b6d28341edd00152568a20970c046e6d627380980e28ddd760378165672fa3f353cd5c00be92a807e736abd4a63132065d52170466726f6e8801336503f62c4a4cbb46a3b4c3e2a518e54fe4cf38afb1896c58e8946fe872a7dd00056e6d62730101182a5e6d074ef60cb186e4eea30c96efcadb80cf56f2bfb4510c946ac09b66534cd162481f70476f569cbe1a2794c1ee7f2cbb74db348155f7ff510dd793ce8d05000000050000000000010000003500e8030000fdafa4768e7e262a12a1875b1dbc24cbbb90b38f2be84ec4d94e75d757eec885d095791799f17abd43bcdb6b96f9de4695cff066fdd1408b3708fcefb5e0225c57213991cf90252a6cc8d9bb9a70a0316cb3b837395059cbfdacff76eea05444f2d6b26b524118822158bee5b7ccebdedbd58f21481ef2ae47bf3c261177320240193451e70178d7811e65e1f275767c2d225fe7f9f908b3bf488c16d097d0a668c216a8c9fd49357d7b80027fd967c18524a5226231244806aeea0a75ee3517fb0c12d46d6f22559dbcd853462a0bc628aef694e2443dfd81efac7f00192086f9d85e866dd807752fa033bb819903cb9898d118e9321c350666a6d942a91ec220162c710c4c02ab787717f755ca3cf3b23d433a9104f711f91ca1960ec8d6bd6fe5ef85743c01bb7dfd30c623bfe4ba3f6eb2546a4af35ff918592a4f543cb3e902a9aad0349f3a16989ec19e0b1e290a6d7451dadcda92b33700b3bbf0bd6ed32d527117004c1ec0d5d745bb89ad2e1eb43ef106637e897503908553dfe8b07c48b77fc499e03154beee380506c3cde81852c60baaa25d252d22132177021c739b612ef498080661757261206bdf14080000000005617572610101f0b283df50f8a78855e3e1c94ca57fb30932b7c1354d4987e249066c468c34670d9c3e3e94a1b510bff7475eb03ff4e4828e4fcd48df4bf926c95b9dada1e78e00000000000000000000010000003500d0070000fdafa4768e7e262a12a1875b1dbc24cbbb90b38f2be84ec4d94e75d757eec8854449da57de66ba8dde40996ee26fd59f388170c7177b155b707a5900d972a11094fef6471442f400bf00aea16568e4aaf33e3fe813f84b10306979fb16e3b590c9c19acc01f972f5b8625513e7c6169d5e58c261697c2e994da969db51b9ee325da4ca2b0d1a734c6691a9af3b8ce6e9ae8f4893be147f47c3c38e68c570fa359c4aee7c3ed8ea350b60849f7e64fb2e5e7fed1bd444cf8b9a11f29d9013ad0b2072a1c0c27da2d70b342dd15f292a26d152486b7ddd901f1afd475dda7c628105f4a8b02f56efae7fefc2bcca459a8cec5ae1ba78b46abef6a5d2c4ebe5f206d9660e7d73163f7b2e1591c08c60e68f4b47cb85dcba54d55c53b9573876f55edd936a472b1527293f1eb259abd21ace9cd93d934102b40d806063659990b6fce9022e3eaa7c75db51c496e55118578a7a19ed4a27b5026b40e589d67af89b01bbd31e4f0b002c57fb874f2dc2e3f8cc56df82b356941adb5891a170d73f4c0af1f9ff63a29b544830fa7f42f0b398248eea97016ff8e01a43ab43db0209d60101b173cbe21e080661757261206bdf14080000000005617572610101fa3a89681c0013963c5c2f42c920d23a6d5e30245a53b9494cc8d9ddea00bb72e0b921b4bd550d8c31fe5578d9a904e05a23893b7698eed64c9ff7c190af1b8201000000010000000000010000003500d4070000fdafa4768e7e262a12a1875b1dbc24cbbb90b38f2be84ec4d94e75d757eec8850a5439e8f4dac89900768ac9d4d125ea7b42b8dcbd4e4c3cef48b6df702673215d86f5ec2f5461dce5a1fd1ca1b2191d7760aae3e78a063d5d10f917144e3f44b7347295ff7caf0e844c3f26d13c936e5750ae202df34dff3f6b93dff15a4fe053b1f03f94810a9adc71fbc024506949229c4da6e708014128d3a84f8395752fe0db0b074b8d2c228e7afb631d05b7585e5448b586d3269af84599af4117c076b12cbfbc68d68aefef71fcd2a5436b941a28e200e100f001899960ac47c0de8bb1c3e877662490d796a9c71077518273d330106d97615cbf6536cb7a725d6cd41e9b1033adc75fd61767027b70ebbabd187ef0219c766fd9c3ed3deacb9916c26f410c35e392a9713fd09184bcb0b661c2ffd54827baba1a7f5609cd5591fb05e90299f03892d3d85b33181b76f7efc19aff5d0389ba61548708d2695b05a0c524e036b4020081215f90c7cf545b1522ad0cd924c1609dc2302a129e631688c28451fada20d99c84b8730309ea9704bcf8fb66f6c71c952549cfe23e2c397b31f4a55d03600e080661757261206bdf14080000000005617572610101fa0900d294c4bdebee8b08295e045fd1b4f0c42c4a8e3d91ace87c309e7cdd76b14ae57d752a970992db8ee24e281616dbff7840d1e898f33e44fdff0fbf358803000000030000000000010000003500d7070000fdafa4768e7e262a12a1875b1dbc24cbbb90b38f2be84ec4d94e75d757eec885c8b457423262f28e194c2204f56160f940c873355164e93b760a8340d4144638cdb28408a73b8bc7ded338e07df4ba8abf7b2f37cd5a06c8776e0b9c2eb664f0a42326e20a2adae3d80499e1d2ee3c7713d0784a9316a0800d1f4e3312c290c6607994ce7041cccb321cff3ede3860ee68d08062716e282106de92641c7cd73a6e7e591c5fdcf78785c327901a4c96207673ef2929a540cc2eae158a96e9d9572afe922e831e87e57ff5ab0d8fd22c4c5e4c602a771249757058e18d0e2c728c603d64bee912c08936feb39d70a3adf534cd38b1045ec20d864bef297b39b27bc290bc1d6b20d8d48eb7ce6d13e3f034cab63be29a1181e4d4a5fcd500c2843ae7d1c58ea1155c38846017075d6ea79b8d4ad53937f1d83acc9f2d6528341fb99501155ed216dad737817e3eb5766bc45cdef738823781d96cb50c2f0f051d6c74f79e130500c5138b98b5ff9b79fc578bccd16b159a3bc788e59e63ae1617d1c39a0f85e66e6e8bd95b1b5948effc1c4111cb3e92a38fe9f2655f764b296d4d6f9e5b866516000400000004000000000001000000000000cdec0e00000000020000'

async function main() {
  const api = await getApi();

  const allEvents = api.registry.createType(
    "Vec<EventRecord>",
    eventsHex,
    true
  );

  console.log(allEvents)
}

main().catch(console.error).finally(() => {
  process.exit(0)
});
